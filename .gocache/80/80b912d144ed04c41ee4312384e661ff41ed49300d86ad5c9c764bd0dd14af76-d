// Code generated by cmd/cgo; DO NOT EDIT.

//line /Users/hujiayilu/go/pkg/mod/github.com/shirou/gopsutil/v3@v3.23.10/disk/disk_darwin_cgo.go:1:1
//go:build darwin && cgo && !ios
// +build darwin,cgo,!ios

package disk

/*
#cgo LDFLAGS: -framework CoreFoundation -framework IOKit
#include <stdint.h>
#include <CoreFoundation/CoreFoundation.h>
#include "iostat_darwin.h"
*/
import _ "unsafe"

import (
	"context"

	"github.com/shirou/gopsutil/v3/internal/common"
)

func IOCountersWithContext(ctx context.Context, names ...string) (map[string]IOCountersStat, error) {
	var buf [( /*line :21:11*/_Ciconst_NDRIVE /*line :21:18*/)] /*line :21:20*/_Ctype_DriveStats /*line :21:32*/
	n, err := ( /*line :22:12*/_C2func_gopsutil_v3_readdrivestat /*line :22:38*/)(&buf[0],  /*line :22:49*/_Ctype_int /*line :22:54*/(len(buf)))
	if err != nil {
		return nil, err
	}
	ret := make(map[string]IOCountersStat, 0)
	for i := 0; i < int(n); i++ {
		d := IOCountersStat{
			ReadBytes:  uint64(buf[i].read),
			WriteBytes: uint64(buf[i].written),
			ReadCount:  uint64(buf[i].nread),
			WriteCount: uint64(buf[i].nwrite),
			ReadTime:   uint64(buf[i].readtime / 1000 / 1000), // note: read/write time are in ns, but we want ms.
			WriteTime:  uint64(buf[i].writetime / 1000 / 1000),
			IoTime:     uint64((buf[i].readtime + buf[i].writetime) / 1000 / 1000),
			Name:       ( /*line :36:16*/_Cfunc_GoString /*line :36:25*/)(&buf[i].name[0]),
		}
		if len(names) > 0 && !common.StringsHas(names, d.Name) {
			continue
		}

		ret[d.Name] = d
	}
	return ret, nil
}
